From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Sander de Leeuw <s.deleeuw@gmail.com>
Date: Sat, 11 Nov 2023 22:38:35 +0000
Subject: video: meson: add HDMI fail-safe FullHD option

Original patch from: Artem Lapkin <art@khadas.com>
https://github.com/khadas/khadas-uboot/blob/master/packages/u-boot-mainline/patches/v2021.10/meson64.patches/0029-video-meson-add-HDMI-fail-save-FullHD-option.patch
---
 drivers/video/meson/meson_vpu.c | 14 ++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

diff --git a/drivers/video/meson/meson_vpu.c b/drivers/video/meson/meson_vpu.c
index 67d4ce7b3b..58341597fc 100644
--- a/drivers/video/meson/meson_vpu.c
+++ b/drivers/video/meson/meson_vpu.c
@@ -51,12 +51,22 @@ static int meson_vpu_setup_mode(struct udevice *dev, struct udevice *disp)
 	int ret = 0;
 
 	if (disp) {
 		ret = display_read_timing(disp, &timing);
 		if (ret) {
-			debug("%s: Failed to read timings\n", __func__);
-			goto cvbs;
+			printf("DISPLAY: setup fail-safe FullHD mode\n");
+			timing.pixelclock.typ = 148500000;
+			timing.hactive.typ = 1920;
+			timing.hfront_porch.typ = 88;
+			timing.hback_porch.typ = 148;
+			timing.hsync_len.typ = 44;
+			timing.vactive.typ = 1080;
+			timing.vfront_porch.typ = 4;
+			timing.vback_porch.typ = 36;
+			timing.vsync_len.typ = 5;
+			timing.flags = 10;
+			timing.hdmi_monitor = true;
 		}
 
 		uc_priv->xsize = timing.hactive.typ;
 		uc_priv->ysize = timing.vactive.typ;
 
-- 
Created with Armbian build tools https://github.com/armbian/build

